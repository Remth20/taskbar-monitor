<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="290px" preserveAspectRatio="none" style="width:940px;height:290px;background:#FFFFFF;" version="1.1" viewBox="0 0 940 290" width="940px" zoomAndPan="magnify"><defs><filter height="300%" id="f1dlzb8msbgl4g" width="300%" x="-1" y="-1"><feGaussianBlur result="blurOut" stdDeviation="2.0"/><feColorMatrix in="blurOut" result="blurOut2" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"/><feOffset dx="4.0" dy="4.0" in="blurOut2" result="blurOut3"/><feBlend in="SourceGraphic" in2="blurOut3" mode="normal"/></filter></defs><g><!--MD5=[3cb35d41d20696f0b0a895aed98282a1]
class TaskbarManager--><rect codeLine="1" fill="#FEFECE" filter="url(#f1dlzb8msbgl4g)" height="269.375" id="TaskbarManager" style="stroke:#A80036;stroke-width:1.5;" width="919" x="7" y="7"/><ellipse cx="415.75" cy="23" fill="#ADD1B2" rx="11" ry="11" style="stroke:#A80036;stroke-width:1.0;"/><path d="M418.5156,18.875 Q418.6719,18.6563 418.8594,18.5469 Q419.0469,18.4375 419.2656,18.4375 Q419.6406,18.4375 419.875,18.6953 Q420.1094,18.9531 420.1094,19.5625 L420.1094,21.0156 Q420.1094,21.625 419.875,21.8906 Q419.6406,22.1563 419.2656,22.1563 Q418.9219,22.1563 418.7188,21.9531 Q418.5156,21.7656 418.4063,21.25 Q418.3594,20.8906 418.1719,20.7031 Q417.8438,20.3281 417.2344,20.1094 Q416.625,19.8906 416,19.8906 Q415.2344,19.8906 414.6016,20.2188 Q413.9688,20.5469 413.4766,21.2969 Q412.9844,22.0469 412.9844,23.0781 L412.9844,24.1719 Q412.9844,25.4063 413.875,26.2266 Q414.7656,27.0469 416.3594,27.0469 Q417.2969,27.0469 417.9531,26.7969 Q418.3438,26.6406 418.7656,26.2031 Q419.0313,25.9375 419.1797,25.8594 Q419.3281,25.7813 419.5313,25.7813 Q419.8594,25.7813 420.1172,26.0391 Q420.375,26.2969 420.375,26.6406 Q420.375,26.9844 420.0313,27.3906 Q419.5313,27.9688 418.7344,28.2969 Q417.6563,28.75 416.3594,28.75 Q414.8438,28.75 413.6406,28.125 Q412.6563,27.625 411.9688,26.5547 Q411.2813,25.4844 411.2813,24.2031 L411.2813,23.0469 Q411.2813,21.7188 411.8984,20.5703 Q412.5156,19.4219 413.6094,18.8047 Q414.7031,18.1875 415.9375,18.1875 Q416.6719,18.1875 417.3203,18.3516 Q417.9688,18.5156 418.5156,18.875 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="93" x="436.25" y="27.9102">TaskbarManager</text><line style="stroke:#A80036;stroke-width:1.5;" x1="8" x2="925" y1="39" y2="39"/><rect fill="none" height="6" style="stroke:#C82930;stroke-width:1.0;" width="6" x="15" y="47"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="115" x="27" y="54.4189">TargetWnd : List&lt;IntPtr&gt;</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="68" x="27" y="68.2549">g_hook : IntPtr</text><ellipse cx="18" cy="77.6719" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;fill:none;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="221" x="27" y="82.0908">OnTopControls : List&lt;SystemWatcherControl&gt;</text><rect fill="none" height="6" style="stroke:#C82930;stroke-width:1.0;" width="6" x="15" y="88.5078"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="210" x="27" y="95.9268">_mainControl : SystemWatcherControl = null</text><ellipse cx="18" cy="105.3438" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;fill:none;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="206" x="27" y="109.7627">MainControl : SystemWatcherControl «get»</text><line style="stroke:#A80036;stroke-width:1.5;" x1="8" x2="925" y1="116.1797" y2="116.1797"/><ellipse cx="18" cy="127.1797" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="114" x="27" y="131.5986">UpdatePositions() : void</text><ellipse cx="18" cy="141.0156" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="127" x="27" y="145.4346">AddControlsWin11() : bool</text><ellipse cx="18" cy="154.8516" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="163" x="27" y="159.2705">AddControlsExtraMonitors() : bool</text><rect fill="#F24D5C" height="6" style="stroke:#C82930;stroke-width:1.0;" width="6" x="15" y="165.6875"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="94" x="27" y="173.1064">HookEvents() : void</text><ellipse cx="18" cy="182.5234" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="116" x="27" y="186.9424">RemoveControls() : void</text><rect fill="#F24D5C" height="6" style="stroke:#C82930;stroke-width:1.0;" width="6" x="15" y="193.3594"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="459" x="27" y="200.7783">InitializeWinEventToHandlerMap() : Dictionary&lt;AccessibleEvents, BLL.Win32Api.WinEventProc&gt;</text><rect fill="#F24D5C" height="6" style="stroke:#C82930;stroke-width:1.0;" width="6" x="15" y="207.1953"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="834" x="27" y="214.6143">DestroyCallback(winEventHookHandle:IntPtr, accEvent:AccessibleEvents, windowHandle:IntPtr, objectId:int, childId:int, eventThreadId:uint, eventTimeInMilliseconds:uint) : void</text><rect fill="#F24D5C" height="6" style="stroke:#C82930;stroke-width:1.0;" width="6" x="15" y="221.0313"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="864" x="27" y="228.4502">ObjectInvokedCallback(winEventHookHandle:IntPtr, accEvent:AccessibleEvents, windowHandle:IntPtr, objectId:int, childId:int, eventThreadId:uint, eventTimeInMilliseconds:uint) : void</text><rect fill="#F24D5C" height="6" style="stroke:#C82930;stroke-width:1.0;" width="6" x="15" y="234.8672"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="893" x="27" y="242.2861">SystemCaptureStartCallback(winEventHookHandle:IntPtr, accEvent:AccessibleEvents, windowHandle:IntPtr, objectId:int, childId:int, eventThreadId:uint, eventTimeInMilliseconds:uint) : void</text><rect fill="#F24D5C" height="6" style="stroke:#C82930;stroke-width:1.0;" width="6" x="15" y="248.7031"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="888" x="27" y="256.1221">SystemCaptureEndCallback(winEventHookHandle:IntPtr, accEvent:AccessibleEvents, windowHandle:IntPtr, objectId:int, childId:int, eventThreadId:uint, eventTimeInMilliseconds:uint) : void</text><rect fill="#F24D5C" height="6" style="stroke:#C82930;stroke-width:1.0;" width="6" x="15" y="262.5391"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="162" x="27" y="269.958">DestroyHelper(state:object) : void</text><!--MD5=[e29ee188125882e75ef95aba8078a50e]
@startuml
class TaskbarManager {
    - TargetWnd : List<IntPtr>
    g_hook : IntPtr
    + OnTopControls : List<SystemWatcherControl>
    - _mainControl : SystemWatcherControl = null
    + MainControl : SystemWatcherControl <<get>>
    + UpdatePositions() : void
    + AddControlsWin11() : bool
    + AddControlsExtraMonitors() : bool
    - HookEvents() : void
    + RemoveControls() : void
    - InitializeWinEventToHandlerMap() : Dictionary<AccessibleEvents, BLL.Win32Api.WinEventProc>
    - DestroyCallback(winEventHookHandle:IntPtr, accEvent:AccessibleEvents, windowHandle:IntPtr, objectId:int, childId:int, eventThreadId:uint, eventTimeInMilliseconds:uint) : void
    - ObjectInvokedCallback(winEventHookHandle:IntPtr, accEvent:AccessibleEvents, windowHandle:IntPtr, objectId:int, childId:int, eventThreadId:uint, eventTimeInMilliseconds:uint) : void
    - SystemCaptureStartCallback(winEventHookHandle:IntPtr, accEvent:AccessibleEvents, windowHandle:IntPtr, objectId:int, childId:int, eventThreadId:uint, eventTimeInMilliseconds:uint) : void
    - SystemCaptureEndCallback(winEventHookHandle:IntPtr, accEvent:AccessibleEvents, windowHandle:IntPtr, objectId:int, childId:int, eventThreadId:uint, eventTimeInMilliseconds:uint) : void
    - DestroyHelper(state:object) : void
}
@enduml

PlantUML version 1.2021.10(Mon Aug 30 10:43:48 BRT 2021)
(GPL source distribution)
Java Runtime: Java(TM) SE Runtime Environment
JVM: Java HotSpot(TM) Client VM
Default Encoding: Cp1252
Language: pt
Country: BR
--></g></svg>